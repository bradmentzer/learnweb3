# Solidity mixed topics

For a more detailed explination, checkout the [docs](https://ethereum.org/hr/developers/tutorials/erc20-annotated-code/)

## Providers and Signers

A provider is an Ethereum node connection that allows a user to read data from it's state. providers are used to call read-only functions, fetching balances, fetching transaction details.

A signer is an Ethereum node that allows a user to write data to the blockchain. The signer needs access to a private key for making transactions.

Wallets like MetaMask inject a provider into the browser so dApps can use this provider to read the blockchain network.
To make transactions, MetaMask allows wesites to request a signer and MetaMask will ask to confirm the transaction.

## ABI

Application Binary Interface.

When Solidity code is compiled into bytecode, it does not contain a record of function names, parameters, or return values that existed within the contract.

Calling a Solidity function in a web app requires a way to call the compiled code.

ABIs are automatically generated by the compiler and contains rules and metadata about the contract functions. Calling a contract requires the address and the ABI. Libraries like ethers.js use the ABI to encode and decode functions into bytecode when interacting with a node.

## Approve and Transfer

The payable keyword only works for ETH transactions.

- Alice wants to sell her NFT
- Alice wants to accept payment for her NFT in her own cryptocurrency, AliceCoin
- Alice's NFT costs 10 AliceCoin
- Bob owns AliceCoin
- Bob wants to buy Alice's NFT
- Bob needs a way to call a function on Alice's NFT smart contract, which would take the 10 Alicecoin payment, and send him his NFT
- Since smart contracts cannot accept Alicecoin as payment directly, Alice has coded up the ERC20 Approval and Transfer flow in her NFT contract
  `approve(address spender, uint256 amount)`
  This allows a user to approve an address to spend the amount of tokens. The function provides an allowance to the spender.
  `transferFrom(address from, address to, uint256 amount)`
  This allows a user to transfer amount token 'from' to 'to'. The from address must have given the user allowance to apend amount using approve()
- Bob gives Alice's NFT contract the allowance to spend up to 10 of his Alicecoin using the approve function
- Bob calls the function to purchase Alice's NFT on her NFT contract
- The purchase function internally calls transferFrom on Alicecoin and transfers 10 Alicecoin from Bob's account to Alice's account
- Since the contract was given the allowance to spend up to 10 Alicecoin by Bob earlier, this action is permitted
- Alice therefore receives her 10 Alicecoin, and Bob receives his NFT

Bob has to do two transactions.

- Transaction 1 - Give allowance to the contract
- Transaction 2 - Call the contract function, which internally uses the allowance to transfer Bob's tokens to a different address
